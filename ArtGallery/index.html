<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Portfolio</title>

<style>
/* --- SAME STYLES YOU HAD --- */
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Arial;background:#fff}
nav{border-bottom:2px solid black;padding:20px 40px;display:flex;justify-content:space-between}
.nav-links{display:flex;gap:20px;list-style:none}
.nav-links a{color:black;text-decoration:none}
.main-content{padding:40px}
.gallery-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:20px}
.portfolio-item{border:2px solid black;cursor:pointer}
.item-preview{height:180px;border-bottom:2px solid black}
.item-preview img{width:100%;height:100%;object-fit:cover}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);justify-content:center;align-items:center}
.modal.active{display:flex}
.modal-content{background:white;border:2px solid black;padding:20px;width:400px}
@media (prefers-color-scheme: dark){
 body{background:#111;color:#eee}
 nav{border-bottom:2px solid #eee}
 .portfolio-item{border:2px solid #eee}
}
</style>
</head>

<body>
<nav>
  <div>PORTFOLIO</div>
  <ul class="nav-links">
    <li><a href="index.html">Home</a></li>
    <li><a href="login.html" id="account-link">Login</a></li>
  </ul>
</nav>

<div class="main-content">
  <button id="openModal">+ Create Project</button>
  <div class="gallery-grid" id="gallery"></div>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-content">
    <h3>Create Project</h3><br>

    <input id="name" placeholder="Project name"><br><br>
    <textarea id="desc" placeholder="Description"></textarea><br><br>

    <button id="pickThumb">Upload Thumbnail</button>
    <input type="file" id="thumbFile" accept="image/*" hidden><br><br>
    <img id="thumbPreview" style="width:100%;display:none">

    <br><br>
    <button id="create">Create</button>
  </div>
</div>

<script>
const projects = [];

const modal = document.getElementById("modal");
const gallery = document.getElementById("gallery");

document.getElementById("openModal").onclick = () => modal.classList.add("active");
modal.onclick = e => e.target === modal && modal.classList.remove("active");

let thumbnailData = "";

document.getElementById("pickThumb").onclick = () =>
  document.getElementById("thumbFile").click();

document.getElementById("thumbFile").onchange = e => {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = ev => {
    thumbnailData = ev.target.result;
    const img = document.getElementById("thumbPreview");
    img.src = thumbnailData;
    img.style.display = "block";
  };
  reader.readAsDataURL(file);
};

document.getElementById("create").onclick = () => {
  const name = document.getElementById("name").value;
  const desc = document.getElementById("desc").value;

  projects.push({ name, desc, thumbnail: thumbnailData });
  render();

  thumbnailData = "";
  document.getElementById("thumbPreview").style.display = "none";
  modal.classList.remove("active");
};

function render(){
  gallery.innerHTML = "";
  projects.forEach(p=>{
    const div = document.createElement("div");
    div.className = "portfolio-item";
    div.innerHTML = `
      <div class="item-preview">
        <img src="${p.thumbnail}">
      </div>
      <div style="padding:10px">
        <b>${p.name}</b><br>
        <small>${p.desc}</small>
      </div>`;
    gallery.appendChild(div);
  });
}

// SESSION CHECK (unchanged logic)
fetch("/api/session").then(r=>r.json()).then(d=>{
  if(d.loggedIn){
    const link=document.getElementById("account-link");
    link.textContent="Logout";
    link.onclick=async e=>{
      e.preventDefault();
      await fetch("/api/logout",{method:"POST"});
      location.href="login.html";
    }
  }
});
</script>
</body>
</html>

